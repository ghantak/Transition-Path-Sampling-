bomblevel -1
wrnlev 10
prnlev 10 
faster

read rtf  card name toppar/top_all36_prot.rtf
read rtf  card name toppar/top_all36_carb.rtf append
read para card name toppar/par_all36_prot.prm flex
read para card name toppar/par_all36_carb.prm flex append 
stream toppar/toppar_water_ions.str
read rtf  card name toppar/top_all36_na.rtf append
read para card name toppar/par_all36_na.prm flex append
stream toppar/stream/na/toppar_all36_na_nad_ppi.str
stream toppar/qm4_prot.str


read psf card name nstart.psf
read coord card name nstart.crd

coor orie sele ALL end
coor stat sele ALL end
calc RADIUS = ( ?XMAX - ?XMIN + 30 ) /2
!calc disp1 = @radius + 0.7

define SOLUTE sele segid MYH7 .or. segid ATP .or. segid QMRE end
! move to have center of system x,y, and z-coordinates RADIUS A from origin
! i.e. place SOLUTE centered at (RADIUS,RADIUS,RADIUS) in first octant 

!!(1)
!coor orient sele SOLUTE end
!coor stat sele SOLUTE end
!coor trans xdir @RADIUS ydir @RADIUS zdir @RADIUS

stream solvent-sphere.str
rename segid BULK sele segid WAT4 end
join BULK renumber

cons fix sele NONE end

write psf card name nsolv.psf
write coor card name nsolv.crd

STOP

